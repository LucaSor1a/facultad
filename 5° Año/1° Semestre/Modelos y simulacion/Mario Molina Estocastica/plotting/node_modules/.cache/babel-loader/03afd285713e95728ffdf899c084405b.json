{"ast":null,"code":"// token types\nvar tokenType = require('./token-type');\n\nvar ESCAPES = {\n  'n': '\\n',\n  'f': '\\f',\n  'r': '\\r',\n  't': '\\t',\n  'v': '\\v',\n  '\\'': '\\'',\n  '\"': '\"'\n};\nvar DELIMITERS = {\n  ',': true,\n  '(': true,\n  ')': true,\n  '[': true,\n  ']': true,\n  ';': true,\n  // unary\n  '~': true,\n  // factorial\n  '!': true,\n  // arithmetic operators\n  '+': true,\n  '-': true,\n  '*': true,\n  '/': true,\n  '%': true,\n  '^': true,\n  '**': true,\n  // python power like\n  // misc operators\n  '|': true,\n  // bitwise or\n  '&': true,\n  // bitwise and\n  '^|': true,\n  // bitwise xor\n  '=': true,\n  ':': true,\n  '?': true,\n  '||': true,\n  // logical or\n  '&&': true,\n  // logical and\n  'xor': true,\n  // logical xor\n  // relational\n  '==': true,\n  '!=': true,\n  '===': true,\n  '!==': true,\n  '<': true,\n  '>': true,\n  '>=': true,\n  '<=': true,\n  // shifts\n  '>>>': true,\n  '<<': true,\n  '>>': true\n}; // helpers\n\nfunction isDigit(c) {\n  return c >= '0' && c <= '9';\n}\n\nfunction isIdentifier(c) {\n  return c >= 'a' && c <= 'z' || c >= 'A' && c <= 'Z' || c === '$' || c === '_';\n}\n\nfunction isWhitespace(c) {\n  return c === ' ' || c === '\\r' || c === '\\t' || c === '\\n' || c === '\\v' || c === \"\\xA0\";\n}\n\nfunction isDelimiter(str) {\n  return DELIMITERS[str];\n}\n\nfunction isQuote(c) {\n  return c === '\\'' || c === '\"';\n} // lexer\n\n\nfunction Lexer() {}\n\nLexer.prototype.throwError = function (message, index) {\n  index = typeof index === 'undefined' ? this.index : index;\n  var error = new Error(message + ' at index ' + index);\n  error.index = index;\n  error.description = message;\n  throw error;\n};\n\nLexer.prototype.lex = function (text) {\n  this.text = text;\n  this.index = 0;\n  this.tokens = [];\n\n  while (this.index < this.text.length) {\n    // skip whitespaces\n    while (isWhitespace(this.peek())) {\n      this.consume();\n    }\n\n    var c = this.peek();\n    var c2 = c + this.peek(1);\n    var c3 = c2 + this.peek(2); // order\n    // - delimiter of 3 characters\n    // - delimiter of 2 characters\n    // - delimiter of 1 character\n    // - number\n    // - variables, functions and named operators\n\n    if (isDelimiter(c3)) {\n      this.tokens.push({\n        type: tokenType.DELIMITER,\n        value: c3\n      });\n      this.consume();\n      this.consume();\n      this.consume();\n    } else if (isDelimiter(c2)) {\n      this.tokens.push({\n        type: tokenType.DELIMITER,\n        value: c2\n      });\n      this.consume();\n      this.consume();\n    } else if (isDelimiter(c)) {\n      this.tokens.push({\n        type: tokenType.DELIMITER,\n        value: c\n      });\n      this.consume();\n    } else if (isDigit(c) || c === '.' && isDigit(this.peek(1))) {\n      this.tokens.push({\n        type: tokenType.NUMBER,\n        value: this.readNumber()\n      });\n    } else if (isQuote(c)) {\n      this.tokens.push({\n        type: tokenType.STRING,\n        value: this.readString()\n      });\n    } else if (isIdentifier(c)) {\n      this.tokens.push({\n        type: tokenType.SYMBOL,\n        value: this.readIdentifier()\n      });\n    } else {\n      this.throwError('unexpected character ' + c);\n    }\n  } // end token\n\n\n  this.tokens.push({\n    type: tokenType.EOF\n  });\n  return this.tokens;\n};\n\nLexer.prototype.peek = function (nth) {\n  nth = nth || 0;\n\n  if (this.index + nth >= this.text.length) {\n    return;\n  }\n\n  return this.text.charAt(this.index + nth);\n};\n\nLexer.prototype.consume = function () {\n  var current = this.peek();\n  this.index += 1;\n  return current;\n};\n\nLexer.prototype.readNumber = function () {\n  var number = '';\n\n  if (this.peek() === '.') {\n    number += this.consume();\n\n    if (!isDigit(this.peek())) {\n      this.throwError('number expected');\n    }\n  } else {\n    while (isDigit(this.peek())) {\n      number += this.consume();\n    }\n\n    if (this.peek() === '.') {\n      number += this.consume();\n    }\n  } // numbers after the decimal dot\n\n\n  while (isDigit(this.peek())) {\n    number += this.consume();\n  } // exponent if available\n\n\n  if (this.peek() === 'e' || this.peek() === 'E') {\n    number += this.consume();\n\n    if (!(isDigit(this.peek()) || this.peek() === '+' || this.peek() === '-')) {\n      this.throwError();\n    }\n\n    if (this.peek() === '+' || this.peek() === '-') {\n      number += this.consume();\n    }\n\n    if (!isDigit(this.peek())) {\n      this.throwError('number expected');\n    }\n\n    while (isDigit(this.peek())) {\n      number += this.consume();\n    }\n  }\n\n  return number;\n};\n\nLexer.prototype.readIdentifier = function () {\n  var text = '';\n\n  while (isIdentifier(this.peek()) || isDigit(this.peek())) {\n    text += this.consume();\n  }\n\n  return text;\n};\n\nLexer.prototype.readString = function () {\n  var quote = this.consume();\n  var string = '';\n  var escape;\n\n  while (true) {\n    var c = this.consume();\n\n    if (!c) {\n      this.throwError('string is not closed');\n    }\n\n    if (escape) {\n      if (c === 'u') {\n        var hex = this.text.substring(this.index + 1, this.index + 5);\n\n        if (!hex.match(/[\\da-f]{4}/i)) {\n          this.throwError('invalid unicode escape');\n        }\n\n        this.index += 4;\n        string += String.fromCharCode(parseInt(hex, 16));\n      } else {\n        var replacement = ESCAPES[c];\n\n        if (replacement) {\n          string += replacement;\n        } else {\n          string += c;\n        }\n      }\n\n      escape = false;\n    } else if (c === quote) {\n      break;\n    } else if (c === '\\\\') {\n      escape = true;\n    } else {\n      string += c;\n    }\n  }\n\n  return string;\n};\n\nmodule.exports = Lexer;","map":{"version":3,"sources":["/mnt/sda3/Lucas/Documents/facultad/5° Año/1° Semestre/Modelos y simulaciones/Mario Molina Estocastica/plotting/node_modules/mr-parser/lib/Lexer.js"],"names":["tokenType","require","ESCAPES","DELIMITERS","isDigit","c","isIdentifier","isWhitespace","isDelimiter","str","isQuote","Lexer","prototype","throwError","message","index","error","Error","description","lex","text","tokens","length","peek","consume","c2","c3","push","type","DELIMITER","value","NUMBER","readNumber","STRING","readString","SYMBOL","readIdentifier","EOF","nth","charAt","current","number","quote","string","escape","hex","substring","match","String","fromCharCode","parseInt","replacement","module","exports"],"mappings":"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","sourcesContent":["// token types\nvar tokenType = require('./token-type')\n\nvar ESCAPES = {\n  'n': '\\n',\n  'f': '\\f',\n  'r': '\\r',\n  't': '\\t',\n  'v': '\\v',\n  '\\'': '\\'',\n  '\"': '\"'\n}\n\nvar DELIMITERS = {\n  ',': true,\n  '(': true,\n  ')': true,\n  '[': true,\n  ']': true,\n  ';': true,\n\n  // unary\n  '~': true,\n\n  // factorial\n  '!': true,\n\n  // arithmetic operators\n  '+': true,\n  '-': true,\n  '*': true,\n  '/': true,\n  '%': true,\n  '^': true,\n  '**': true,     // python power like\n\n  // misc operators\n  '|': true,      // bitwise or\n  '&': true,      // bitwise and\n  '^|': true,     // bitwise xor\n  '=': true,\n  ':': true,\n  '?': true,\n\n  '||': true,      // logical or\n  '&&': true,      // logical and\n  'xor': true,     // logical xor\n\n  // relational\n  '==': true,\n  '!=': true,\n  '===': true,\n  '!==': true,\n  '<': true,\n  '>': true,\n  '>=': true,\n  '<=': true,\n\n  // shifts\n  '>>>': true,\n  '<<': true,\n  '>>': true\n}\n\n// helpers\n\nfunction isDigit (c) {\n  return c >= '0' && c <= '9'\n}\n\nfunction isIdentifier (c) {\n  return (c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z') ||\n    c === '$' || c === '_'\n}\n\nfunction isWhitespace (c) {\n  return c === ' ' || c === '\\r' || c === '\\t' ||\n    c === '\\n' || c === '\\v' || c === '\\u00A0'\n}\n\nfunction isDelimiter (str) {\n  return DELIMITERS[str]\n}\n\nfunction isQuote (c) {\n  return c === '\\'' || c === '\"'\n}\n\n// lexer\n\nfunction Lexer () {}\n\nLexer.prototype.throwError = function (message, index) {\n  index = typeof index === 'undefined' ? this.index : index\n\n  var error = new Error(message + ' at index ' + index)\n  error.index = index\n  error.description = message\n  throw error\n}\n\nLexer.prototype.lex = function (text) {\n  this.text = text\n  this.index = 0\n  this.tokens = []\n\n  while (this.index < this.text.length) {\n    // skip whitespaces\n    while (isWhitespace(this.peek())) {\n      this.consume()\n    }\n    var c = this.peek()\n    var c2 = c + this.peek(1)\n    var c3 = c2 + this.peek(2)\n\n    // order\n    // - delimiter of 3 characters\n    // - delimiter of 2 characters\n    // - delimiter of 1 character\n    // - number\n    // - variables, functions and named operators\n    if (isDelimiter(c3)) {\n      this.tokens.push({\n        type: tokenType.DELIMITER,\n        value: c3\n      })\n      this.consume()\n      this.consume()\n      this.consume()\n    } else if (isDelimiter(c2)) {\n      this.tokens.push({\n        type: tokenType.DELIMITER,\n        value: c2\n      })\n      this.consume()\n      this.consume()\n    } else if (isDelimiter(c)) {\n      this.tokens.push({\n        type: tokenType.DELIMITER,\n        value: c\n      })\n      this.consume()\n    } else if (isDigit(c) ||\n        (c === '.' && isDigit(this.peek(1)))) {\n      this.tokens.push({\n        type: tokenType.NUMBER,\n        value: this.readNumber()\n      })\n    } else if (isQuote(c)) {\n      this.tokens.push({\n        type: tokenType.STRING,\n        value: this.readString()\n      })\n    } else if (isIdentifier(c)) {\n      this.tokens.push({\n        type: tokenType.SYMBOL,\n        value: this.readIdentifier()\n      })\n    } else {\n      this.throwError('unexpected character ' + c)\n    }\n  }\n\n  // end token\n  this.tokens.push({ type: tokenType.EOF })\n\n  return this.tokens\n}\n\nLexer.prototype.peek = function (nth) {\n  nth = nth || 0\n  if (this.index + nth >= this.text.length) {\n    return\n  }\n  return this.text.charAt(this.index + nth)\n}\n\nLexer.prototype.consume = function () {\n  var current = this.peek()\n  this.index += 1\n  return current\n}\n\nLexer.prototype.readNumber = function () {\n  var number = ''\n\n  if (this.peek() === '.') {\n    number += this.consume()\n    if (!isDigit(this.peek())) {\n      this.throwError('number expected')\n    }\n  } else {\n    while (isDigit(this.peek())) {\n      number += this.consume()\n    }\n    if (this.peek() === '.') {\n      number += this.consume()\n    }\n  }\n\n  // numbers after the decimal dot\n  while (isDigit(this.peek())) {\n    number += this.consume()\n  }\n\n  // exponent if available\n  if ((this.peek() === 'e' || this.peek() === 'E')) {\n    number += this.consume()\n\n    if (!(isDigit(this.peek()) ||\n        this.peek() === '+' ||\n        this.peek() === '-')) {\n      this.throwError()\n    }\n\n    if (this.peek() === '+' || this.peek() === '-') {\n      number += this.consume()\n    }\n\n    if (!isDigit(this.peek())) {\n      this.throwError('number expected')\n    }\n\n    while (isDigit(this.peek())) {\n      number += this.consume()\n    }\n  }\n  return number\n}\n\nLexer.prototype.readIdentifier = function () {\n  var text = ''\n  while (isIdentifier(this.peek()) || isDigit(this.peek())) {\n    text += this.consume()\n  }\n  return text\n}\n\nLexer.prototype.readString = function () {\n  var quote = this.consume()\n  var string = ''\n  var escape\n  while (true) {\n    var c = this.consume()\n    if (!c) {\n      this.throwError('string is not closed')\n    }\n    if (escape) {\n      if (c === 'u') {\n        var hex = this.text.substring(this.index + 1, this.index + 5)\n        if (!hex.match(/[\\da-f]{4}/i)) {\n          this.throwError('invalid unicode escape')\n        }\n        this.index += 4\n        string += String.fromCharCode(parseInt(hex, 16))\n      } else {\n        var replacement = ESCAPES[c]\n        if (replacement) {\n          string += replacement\n        } else {\n          string += c\n        }\n      }\n      escape = false\n    } else if (c === quote) {\n      break\n    } else if (c === '\\\\') {\n      escape = true\n    } else {\n      string += c\n    }\n  }\n  return string\n}\n\nmodule.exports = Lexer\n"]},"metadata":{},"sourceType":"script"}