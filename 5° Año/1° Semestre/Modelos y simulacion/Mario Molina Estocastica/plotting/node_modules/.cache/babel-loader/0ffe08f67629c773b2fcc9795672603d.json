{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar d3_shape_1 = require(\"d3-shape\");\n\nvar d3_selection_1 = require(\"d3-selection\");\n\nfunction annotations(options) {\n  var xScale = options.owner.meta.xScale;\n  var yScale = options.owner.meta.yScale;\n  var line = d3_shape_1.line().x(function (d) {\n    return d[0];\n  }).y(function (d) {\n    return d[1];\n  });\n  return function (parentSelection) {\n    parentSelection.each(function () {\n      // join\n      var current = d3_selection_1.select(this);\n      var selection = current.selectAll('g.annotations').data(function (d) {\n        return d.annotations || [];\n      }); // enter\n\n      var enter = selection.enter().append('g').attr('class', 'annotations'); // enter + update\n      // - path\n\n      var yRange = yScale.range();\n      var xRange = xScale.range();\n      var path = selection.merge(enter).selectAll('path').data(function (d) {\n        if ('x' in d) {\n          return [[[0, yRange[0]], [0, yRange[1]]]];\n        } else {\n          return [[[xRange[0], 0], [xRange[1], 0]]];\n        }\n      });\n      path.enter().append('path').attr('stroke', '#eee').attr('d', line);\n      path.exit().remove(); // enter + update\n      // - text\n\n      var text = selection.merge(enter).selectAll('text').data(function (d) {\n        return [{\n          text: d.text || '',\n          hasX: 'x' in d\n        }];\n      });\n      text.enter().append('text').attr('y', function (d) {\n        return d.hasX ? 3 : 0;\n      }).attr('x', function (d) {\n        return d.hasX ? 0 : 3;\n      }).attr('dy', function (d) {\n        return d.hasX ? 5 : -5;\n      }).attr('text-anchor', function (d) {\n        return d.hasX ? 'end' : '';\n      }).attr('transform', function (d) {\n        return d.hasX ? 'rotate(-90)' : '';\n      }).text(function (d) {\n        return d.text;\n      });\n      text.exit().remove(); // enter + update\n      // move group\n\n      selection.merge(enter).attr('transform', function (d) {\n        if ('x' in d) {\n          return 'translate(' + xScale(d.x) + ', 0)';\n        } else {\n          return 'translate(0, ' + yScale(d.y) + ')';\n        }\n      }); // exit\n\n      selection.exit().remove();\n    });\n  };\n}\n\nexports.default = annotations;","map":{"version":3,"mappings":"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","names":["annotations","options","xScale","owner","meta","yScale","line","d3_shape_1","x","d","y","parentSelection","each","current","d3_selection_1","selection","selectAll","data","enter","append","attr","yRange","range","xRange","path","merge","exit","remove","text","hasX","exports"],"sourceRoot":"","sources":["../../src/helpers/annotations.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}